<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <style>
    body {
      width: 400px;
      height: 600px;
      padding: 15px;
      font-family: 'Courier New', monospace;
      margin: 0;
      background: #ffffff;
      color: #000000;
      font-size: 16px;
      line-height: 1.333;
      overflow: hidden;
    }
    
    /* RTL Support */
    .rtl {
      direction: rtl;
      text-align: right;
      font-family: 'Segoe UI', 'Tahoma', 'Noto Sans Arabic', 'Arial Unicode MS', sans-serif;
      line-height: 1.6;
      letter-spacing: normal;
    }
    
    .rtl * {
      text-align: right;
      direction: rtl;
    }
    
    .rtl .form-group input,
    .rtl .form-group textarea,
    .rtl .form-group select {
      text-align: right;
      direction: rtl;
    }
    
    .rtl .btn {
      text-align: center;
    }
    
    .rtl .tabs {
      flex-direction: row-reverse;
    }
    
    .rtl .result-header {
      flex-direction: row-reverse;
    }
    
    .rtl .advanced-toggle {
      flex-direction: row-reverse;
    }
    
    .rtl .advanced-toggle::before {
      content: '◀';
      margin-left: 8px;
      margin-right: 0;
    }
    
    .rtl .advanced-toggle.expanded::before {
      content: '▼';
      transform: none;
    }
    
    .rtl .logo {
      font-family: 'Segoe UI', 'Tahoma', 'Noto Sans Arabic', 'Arial Unicode MS', sans-serif;
      letter-spacing: normal;
    }
    
    /* Original Styles */
    .header {
      text-align: center;
      margin-bottom: 15px;
      border-bottom: 1px solid #f4f1f1;
      padding-bottom: 15px;
    }
    
    .logo {
      font-family: 'Chakra Petch', sans-serif;
      font-size: 18px;
      font-weight: 500;
      color: #000000;
      margin-bottom: 5px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      background: linear-gradient(90deg, #565151, #d2caca);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .subtitle {
      color: #6b7280;
      font-size: 12px;
      font-weight: 700;
    }
    
    .privacy-note {
      background: #f4f1f1;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 11px;
      color: #565151;
      margin-bottom: 15px;
      line-height: 1.4;
    }
    
    .tab-container {
      margin-bottom: 10px;
    }
    
    .tabs {
      display: flex;
      border-bottom: 1px solid #d2caca;
      margin-bottom: 15px;
      background: #ffffff;
    }
    
    .tab {
      flex: 1;
      padding: 10px;
      text-align: center;
      background: none;
      border: none;
      cursor: pointer;
      color: #6b7280;
      font-size: 14px;
      font-weight: 700;
      border-bottom: 2px solid transparent;
      font-family: 'Courier New', monospace;
      user-select: none;
      -webkit-user-select: none;
      position: relative;
      z-index: 1;
      pointer-events: auto;
      transition: all 0.2s ease;
    }
    
    .tab:hover {
      color: #000000;
      background: #f4f1f1;
    }
    
    .tab.active {
      color: #000000;
      border-bottom-color: #000000;
      background: none;
    }
    
    .tab:focus {
      outline: 2px solid #000000;
      outline-offset: -2px;
    }
    
    .tab-content {
      display: none;
      padding: 5px 0;
      max-height: 520px;
      overflow-y: auto;
    }
    
    .tab-content.active {
      display: block !important;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 700;
      color: #000000;
      font-size: 14px;
    }
    
    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #d1d5db;
      border-radius: 0;
      font-size: 14px;
      box-sizing: border-box;
      font-family: 'Courier New', monospace;
    }
    
    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: #000000;
    }
    
    .form-group textarea {
      min-height: 120px;
      resize: vertical;
    }
    
    .btn {
      width: 100%;
      padding: 10px;
      background: #000000;
      color: #ffffff;
      border: none;
      border-radius: 0;
      cursor: pointer;
      font-size: 14px;
      font-weight: 700;
      font-family: 'Courier New', monospace;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .btn:hover {
      background: #565151;
    }
    
    .btn:disabled {
      background: #9ca3af;
      cursor: not-allowed;
    }
    
    .result-container {
      margin-top: 20px;
      padding: 15px;
      background: #f4f1f1;
      border: 1px solid #d2caca;
      border-radius: 0;
      display: none;
    }
    
    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .result-title {
      font-weight: 700;
      color: #000000;
    }
    
    .copy-btn {
      padding: 4px 8px;
      background: #000000;
      color: #ffffff;
      border: none;
      border-radius: 0;
      cursor: pointer;
      font-size: 12px;
      font-weight: 700;
      font-family: 'Courier New', monospace;
    }
    
    .copy-btn:hover {
      background: #565151;
    }
    
    .result-content {
      background: #ffffff;
      padding: 12px;
      border-radius: 0;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      line-height: 1.333;
      white-space: pre-wrap;
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid #d2caca;
    }
    
    .error {
      color: #dc2626;
      background: #fef2f2;
      padding: 10px;
      border-radius: 6px;
      font-size: 14px;
      margin-top: 10px;
      display: none;
    }
    
    .success {
      color: #059669;
      background: #f0fdf4;
      padding: 10px;
      border-radius: 6px;
      font-size: 14px;
      margin-top: 10px;
      display: none;
    }
    
    .loading {
      text-align: center;
      color: #64748b;
      padding: 20px;
      display: none;
    }
    
    .quick-actions {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .quick-btn {
      padding: 8px 12px;
      background: #f4f1f1;
      border: 1px solid #d2caca;
      border-radius: 0;
      cursor: pointer;
      text-align: center;
      font-size: 12px;
      color: #565151;
      font-weight: 700;
      font-family: 'Courier New', monospace;
    }
    
    .quick-btn:hover {
      background: #d2caca;
      color: #000000;
    }
    
    .advanced-toggle {
      background: none;
      border: none;
      color: #6b7280;
      font-size: 12px;
      cursor: pointer;
      padding: 8px 0;
      margin: 10px 0;
      display: flex;
      align-items: center;
      font-family: 'Courier New', monospace;
      font-weight: 700;
    }
    
    .advanced-toggle:hover {
      color: #000000;
    }
    
    .advanced-toggle::before {
      content: '▶';
      margin-right: 8px;
      transition: transform 0.2s ease;
    }
    
    .advanced-toggle.expanded::before {
      transform: rotate(90deg);
    }
    
    .advanced-section {
      display: none;
      margin-bottom: 15px;
    }
    
    .advanced-section.expanded {
      display: block;
    }
    
    .settings-tab .form-group {
      margin-bottom: 10px;
    }
    
    .settings-tab .form-group label {
      font-size: 12px;
      margin-bottom: 3px;
    }
    
    .settings-tab .form-group input,
    .settings-tab .form-group select {
      padding: 6px 10px;
      font-size: 12px;
    }
    
    .settings-tab small {
      font-size: 10px;
      margin-top: 3px;
    }
    
    .settings-tab .btn {
      padding: 8px;
      font-size: 12px;
      margin-top: 8px;
    }
    
    .settings-config-header {
      padding: 8px 10px;
      margin-bottom: 10px;
      font-size: 11px;
    }
    
    .settings-privacy-notice {
      padding: 8px 10px;
      margin-top: 10px;
      font-size: 10px;
      line-height: 1.3;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="logo" data-i18n="extension.name">🧪 Labratorium AI Prompt Optimizer</div>
    <div class="subtitle" data-i18n="extension.description">Privacy-focused prompt enhancement</div>
  </div>
  
  <div class="tab-container">
    <div class="tabs">
      <button class="tab active" data-tab="optimize" id="optimize-tab-btn" data-i18n="tabs.optimize">Optimize</button>
      <button class="tab" data-tab="settings" id="settings-tab-btn" data-i18n="tabs.settings">Settings</button>
    </div>
    
    <div class="tab-content active" id="optimize-tab">
      <div class="form-group">
        <label for="user-prompt" data-i18n="optimize.yourPrompt">Your Prompt:</label>
        <textarea id="user-prompt" data-i18n-placeholder="optimize.placeholder">Enter your prompt here to optimize it...</textarea>
      </div>
      
      <button class="advanced-toggle" id="advanced-toggle" data-i18n="optimize.advancedOptions">Advanced Options</button>
      
      <div class="advanced-section" id="advanced-section">
        <div class="form-group">
          <label for="optimization-type" data-i18n="optimize.optimizationType">Optimization Type:</label>
          <select id="optimization-type">
            <option value="general" data-i18n="optimizationTypes.general">General Improvement</option>
            <option value="clarity" data-i18n="optimizationTypes.clarity">Clarity & Specificity</option>
            <option value="creativity" data-i18n="optimizationTypes.creativity">Creative Enhancement</option>
            <option value="technical" data-i18n="optimizationTypes.technical">Technical Precision</option>
            <option value="concise" data-i18n="optimizationTypes.concise">Make Concise</option>
            <option value="detailed" data-i18n="optimizationTypes.detailed">Add More Detail</option>
          </select>
        </div>
        
        <div class="quick-actions">
          <button class="quick-btn" data-template="creative" data-i18n="quickActions.creative">🎨 Creative</button>
          <button class="quick-btn" data-template="analysis" data-i18n="quickActions.analysis">📊 Analysis</button>
          <button class="quick-btn" data-template="writing" data-i18n="quickActions.writing">✍️ Writing</button>
          <button class="quick-btn" data-template="coding" data-i18n="quickActions.coding">💻 Coding</button>
        </div>
      </div>
      
      <button id="optimize-btn" class="btn" data-i18n="optimize.optimizeButton">Optimize Prompt</button>
      
      <div class="loading" id="loading">
        <div data-i18n="optimize.loading">🧪 Labratorium AI is optimizing your prompt...</div>
      </div>
      
      <div class="error" id="error"></div>
      <div class="success" id="success"></div>
      
      <div class="result-container" id="result-container">
        <div class="result-header">
          <span class="result-title" data-i18n="optimize.resultTitle">Optimized Prompt:</span>
          <button class="copy-btn" id="copy-result" data-i18n="optimize.copyButton">Copy</button>
        </div>
        <div class="result-content" id="result-content"></div>
      </div>
      
      <div class="settings-privacy-notice" style="background:#f4f1f1;color:#565151" data-i18n="privacy.notice">
        <strong>🔒 Privacy Notice:</strong> This extension runs entirely in your browser. Your API key is stored locally and your prompts are sent directly to your chosen provider's servers. Labratorium.com has no access to your data.
      </div>
    </div>
    
    <div class="tab-content settings-tab" id="settings-tab">
      <div class="settings-config-header" style="background:#f4f1f1;color:#565151">
        <strong data-i18n="settings.configHeader">🔧 Configuration</strong><br>
        <span data-i18n="settings.configSubtext">Configure your AI provider settings below.</span>
      </div>
      
      <div class="form-group">
        <label for="provider-selection" data-i18n="settings.aiProvider">AI Provider:</label>
        <select id="provider-selection">
          <option value="anthropic" data-i18n="providers.anthropic">Anthropic (Claude)</option>
          <option value="openai" data-i18n="providers.openai">OpenAI (GPT)</option>
          <option value="google" data-i18n="providers.google">Google (Gemini)</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="api-key" data-i18n="settings.apiKey">API Key:</label>
        <input type="password" id="api-key" data-i18n-placeholder="settings.apiKeyPlaceholder">
        <small id="api-key-help">
          <span data-i18n="apiKeyHelp.anthropic">Get your API key from</span> 
          <a href="https://console.anthropic.com/" target="_blank" style="color:#000000" id="api-key-link">Anthropic Console</a>
        </small>
      </div>
      
      <div class="form-group">
        <label for="model-selection" data-i18n="settings.model">Model:</label>
        <select id="model-selection">
          <!-- Options will be populated by JavaScript -->
        </select>
      </div>
      
      <div class="form-group">
        <label for="context-style" data-i18n="settings.optimizationStyle">Optimization Style:</label>
        <select id="context-style">
          <option value="comprehensive" data-i18n="styles.comprehensive">Comprehensive Analysis</option>
          <option value="quick" data-i18n="styles.quick">Quick Improvements</option>
          <option value="structured" data-i18n="styles.structured">Structured Approach</option>
          <option value="creative" data-i18n="styles.creative">Creative Enhancement</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="language-selection" data-i18n="settings.language">Language:</label>
        <select id="language-selection">
          <!-- Options will be populated by JavaScript -->
        </select>
      </div>
      
      <button id="save-settings" class="btn" data-i18n="settings.saveSettings">Save Settings</button>
      <button id="test-api" class="btn" style="background:#565151" data-i18n="settings.testApi">Test API Connection</button>
      
      <div class="error" id="settings-error" style="display:none"></div>
      <div class="success" id="settings-success" style="display:none"></div>
      
      <div class="settings-privacy-notice" style="background:#f4f1f1;color:#565151" data-i18n="privacy.notice">
        <strong>🔒 Privacy Notice:</strong> This extension runs entirely in your browser. Your API key is stored locally and your prompts are sent directly to your chosen provider's servers. Labratorium.com has no access to your data.
      </div>
      
      <div class="settings-version" style="text-align:center;padding:8px 10px;margin-top:10px;font-size:10px;color:#9ca3af;border-top:1px solid #e5e7eb">
        <strong data-i18n="extension.name">Labratorium AI Prompt Optimizer</strong><br>
        <span data-i18n="settings.version">Version 4.0.1 (Latest Stable)</span>
      </div>
    </div>
  </div>
  
  <script src="locales/languages.js"></script>
  <script src="js/i18n.js"></script>
  <script src="popup.js"></script>
</body>
</html>